Uma dúvida de muitos que iniciam no desenvolvimento de jogos é: "Como farei para simular a física?"
Lidar com física nunca é uma tarefa simples. Temos que considerar gravidade, como ela afeta os corpos presentes no espaço, colisão entre os corpos, força de impulso, formas geométricas e etc.
Para que o desenvolvedor não precise se preocupar com todos esses aspectos, diversas engines de física para jogos foram criados.
Veremos o quão fácil é trabalhar com a engine Chipmunk2D, usando o framework Cocos2d-JS para criar nosso jogo!

Baixe a biblioteca do Cocos2d-JS na <a href='http://www.cocos2d-x.org/download' target='_blank'>página de download</a>. Ele ja vem com o Cocos2d-html5 e o Cocos2d-x Javascript Binding, para podermos compilar nosso código para rodar nativamente em dispositivos mobile. Além disso, a biblioteca ja vem com a engine do Chipmunk!

<em>Nota: Este artigo usa a API da versão mais atual do Cocos2d JS até a data (v2.2.2)</em>

Diversos tutoriais básicos sobre Cocos2d podem ser encontrados na <a href='http://www.cocos2d-x.org/wiki/Cocos2d-JS' target='_blank'>página da documentação</a>

Para começarmos a usar a engine de física do Chipmunk2D, temos que declarar nas configurações do Cocos2d que usaremos o chipmunk. Para isso, alteramos <strong>cocos2d.js</strong> adicionamos a seguinte instrução: 

[code language="javascript"]
chipmunk:true,
[/code]

Agora toda vez que carregarmos o Cocos2d, o jsloader carregará também a biblioteca do Chipmunk2D.

Para de fato usarmos a física em uma cena, precisamos de um objeto chamado <strong>space</strong>.
É comum criarmos um método na cena que iniciará todas as configurações de física:

[code language='javascript']
var PhysicScene = cc.Scene.extend({
    space: null,

    initPhysics:function() {
        this.space = new cp.Space();
    },

    onEnter:function () {
        this._super();
        this.initPhysics();
        var layer = new GameLayer(this.space);
        this.addChild(layer);

        this.scheduleUpdate();
    },

    update: function(dt) {
        this.space.step(dt);
    }
});
[/code]

Pronto! Agora ja temos um objeto representando o espaço.
Perceba que passamos o objeto <em>space</em> como parâmetro no construtor do layer!

Para setarmos a força da gravidade em nosso espaço, podemos usar:

[code language='javascript']
this.space.gravity = cp.v(0, -650);
[/code]

Criaremos agora o <strong>GameLayer<strong>:

[code language='javascript']
var GameLayer = cc.Layer.extend({

    ctor : function(space){
        this._super();
        this.space = space;
        this.init();
    },

    init:function(){
        this._super();
    },
});
[/code]

Vamos simular um corpo sendo afetado pela gravidade em nosso espaço.
Representaremos esse corpo com o sprite de uma bola:

[TODO IMAGEM]

Basta salvar esse arquivo no diretório <em>res/Normal/</em>

Para isso, no <strong>GameLayer</strong> criaremos o sprite da bola e o associaremos a um corpo físico:

[code language='javascript']
init:function(){
    this._super();

    // cc.PhysicsSprite cria um sprite que representará um corpo
    var ball = cc.PhysicsSprite.create("ball.png");
    this.addChild(ball);

    var raio = 32;

    // Criando o corpo físico que obedecerá as leis do espaço
    var corpo = this.space.addBody(new cp.Body(10, cp.momentForCircle(10, 0, raio, cp.v(0,0))));

    // Podemos escolher a forma do corpo, a elasticidade e a fricção dele!
    forma = this.space.addShape(new cp.CircleShape(corpo, raio, cp.v(0,0)));
    forma.setElasticity(0.6);
    forma.setFriction(1);

    var s = cc.Director.getInstance().getWinSize();
    corpo.setPos(cp.v(s.width/2, s.height/2));

    ball.setBody(corpo)
},
[/code]

Rode a aplicação e verifique o resultado.
A bola está passando desaparecendo tela! Precisamos criar um chão para que ela permaneça na área visível.

Vamos criar 4 paredes, uma em cada lado da tela, transformando a área jogável em uma espécie de "caixa".
No metodo <strong>initPhysics</striong>, que está no PhysicScene:

[code language='javascript']
var winSize = cc.Director.getInstance().getWinSize();

var staticBody = this.space.staticBody;

var paredes = [ new cp.SegmentShape( staticBody, cp.v(0,0), cp.v(winSize.width,0), 0 ),               // bottom
    new cp.SegmentShape( staticBody, cp.v(0,winSize.height), cp.v(winSize.width,winSize.height), 0),    // top
    new cp.SegmentShape( staticBody, cp.v(0,0), cp.v(0,winSize.height), 0),             // left
    new cp.SegmentShape( staticBody, cp.v(winSize.width,0), cp.v(winSize.width,winSize.height), 0)  // right
];

for( var i=0; i < paredes.length; i++ ) {
    var forma = paredes[i];
    forma.setElasticity(1);
    forma.setFriction(1);
    this.space.addStaticShape( forma );
}
[/code]

Agora nossa bola bate no chão e quica!