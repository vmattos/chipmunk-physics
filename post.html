<h1>Física em jogos com Chipmunk2D</h1>

Uma dúvida de muitos que iniciam no desenvolvimento de jogos é: "Como farei para simular a física?"
Lidar com física nunca é uma tarefa simples. Temos que considerar gravidade, como ela afeta os corpos presentes no espaço, colisão entre os corpos, força de impulso, formas geométricas e etc.
Para que o desenvolvedor não precise se preocupar com todos esses aspectos, diversas engines de física para jogos foram criados.
Veremos o quão fácil é trabalhar com a engine Chipmunk2D, usando o framework Cocos2d-JS para criar nosso jogo!

Baixe a biblioteca do Cocos2d-JS na <a href='http://www.cocos2d-x.org/download' target='_blank'>página de download</a>. Ele ja vem com o Cocos2d-html5 e o Cocos2d-x Javascript Binding, para podermos compilar nosso código para rodar nativamente em dispositivos mobile. Além disso, a biblioteca ja vem com a engine do Chipmunk!

<em>Nota: Este artigo usa a API da versão mais atual do Cocos2d JS até a data (v2.2.2)</em>

Diversos tutoriais básicos sobre Cocos2d podem ser encontrados na <a href='http://www.cocos2d-x.org/wiki/Cocos2d-JS' target='_blank'>página da documentação</a>

Para começarmos a usar a engine de física do Chipmunk2D, temos que declarar nas configurações do Cocos2d que usaremos o chipmunk. Para isso, alteramos <strong>cocos2d.js</strong> adicionamos a seguinte instrução: 

[code language="javascript"]
chipmunk:true,
[/code]

Agora toda vez que carregarmos o Cocos2d, o jsloader carregará também a biblioteca do Chipmunk2D.

Para de fato usarmos a física em uma cena, precisamos de um objeto chamado <strong>space</strong>.
É comum criarmos um método na cena que iniciará todas as configurações de física:

[code language='javascript']
var PhysicScene = cc.Scene.extend({
    space: null,

    initPhysics:function() {
        this.space = new cp.Space();
    },

    onEnter:function () {
        this._super();
        this.initPhysics();
        var layer = new GameLayer(this.space);
        this.addChild(layer);

        this.scheduleUpdate();
    },

    update: function(dt) {
        this.space.step(dt);
    }
});
[/code]

Pronto! Agora ja temos um objeto representando o espaço.
Para setarmos a força da gravidade em nosso espaço, podemos usar:

[code language='javascript']
this.space.gravity = cp.v(0, -650);
[/code]